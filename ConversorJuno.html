<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
</head>
<body>
  <input type="file" accept="audio/*" onchange="encodeFile(this.files[0])" hidden/>
  
  <!-- Script de Thunkable Webviewer Extension -->
  <script src="https://thunkable.github.io/webviewer-extension/thunkableWebviewerExtension.js"></script>
  
  <script>
    function encodeFile(file) {
      let reader = new FileReader();
      reader.onloadend = function() {
        // Enviar la cadena Base64 de vuelta a Thunkable
        ThunkableWebviewerExtension.postMessage(reader.result);
      };
      reader.readAsDataURL(file);  // Lee el archivo como Base64 (Data URL)
    }

    // Carga automÃ¡ticamente el archivo m4a local en Android (Thunkable Live)
    fetch("file:///data/user/0/com.thunkable.live/cache/sound.m4a")
      .then(res => res.blob())
      .then(blob => encodeFile(blob))
      .catch(err => {
        ThunkableWebviewerExtension.postMessage("ERROR AL LEER ARCHIVO: " + err);
      });
  </script>
</body>
</html>
